{"ast":null,"code":"import _slicedToArray from\"/Users/davidbroida/Desktop/MusicMatch2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import axios from'axios';export default function useAuth(code){var _useState=useState(),_useState2=_slicedToArray(_useState,2),accessToken=_useState2[0],setAccessToken=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),refreshToken=_useState4[0],setRefreshToken=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),expiresIn=_useState6[0],setExpiresIn=_useState6[1];useEffect(function(){axios.post('http://localhost:3001/login',{code:code}).then(function(res){setAccessToken(res.data.accessToken);setRefreshToken(res.data.refreshToken);setExpiresIn(res.data.expiresIn);window.history.pushState({},null,'/');}).catch(function(){// window.location = '/'\n});},[code]);useEffect(function(){if(!refreshToken||!expiresIn)return;var interval=setInterval(function(){axios.post('http://localhost:3001/refresh',{refreshToken:refreshToken}).then(function(res){setAccessToken(res.data.accessToken);setExpiresIn(res.data.expiresIn);}).catch(function(){// window.location = '/'\n});},(expiresIn-60)*1000);return function(){return clearInterval(interval);};},[refreshToken,expiresIn]);return accessToken;}","map":{"version":3,"sources":["/Users/davidbroida/Desktop/MusicMatch2/frontend/src/hooks/useAuth.js"],"names":["React","useState","useEffect","axios","useAuth","code","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","post","then","res","data","window","history","pushState","catch","interval","setInterval","clearInterval"],"mappings":"qIAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,cAAe,SAASC,CAAAA,OAAT,CAAiBC,IAAjB,CAAuB,CACpC,cAAsCJ,QAAQ,EAA9C,wCAAOK,WAAP,eAAoBC,cAApB,eACA,eAAwCN,QAAQ,EAAhD,yCAAOO,YAAP,eAAqBC,eAArB,eACA,eAAkCR,QAAQ,EAA1C,yCAAOS,SAAP,eAAkBC,YAAlB,eAEAT,SAAS,CAAC,UAAM,CACdC,KAAK,CAACS,IAAN,CAAW,6BAAX,CAA0C,CACxCP,IAAI,CAAJA,IADwC,CAA1C,EAGGQ,IAHH,CAGQ,SAAAC,GAAG,CAAI,CACXP,cAAc,CAACO,GAAG,CAACC,IAAJ,CAAST,WAAV,CAAd,CACAG,eAAe,CAACK,GAAG,CAACC,IAAJ,CAASP,YAAV,CAAf,CACAG,YAAY,CAACG,GAAG,CAACC,IAAJ,CAASL,SAAV,CAAZ,CACAM,MAAM,CAACC,OAAP,CAAeC,SAAf,CAAyB,EAAzB,CAA6B,IAA7B,CAAmC,GAAnC,EACD,CARH,EAQKC,KARL,CAQW,UAAM,CACb;AACD,CAVH,EAWD,CAZQ,CAYN,CAACd,IAAD,CAZM,CAAT,CAcAH,SAAS,CAAC,UAAM,CACd,GAAI,CAACM,YAAD,EAAiB,CAACE,SAAtB,CAAiC,OACjC,GAAMU,CAAAA,QAAQ,CAAGC,WAAW,CAAC,UAAM,CACjClB,KAAK,CAACS,IAAN,CAAW,+BAAX,CAA4C,CAC1CJ,YAAY,CAAZA,YAD0C,CAA5C,EAGGK,IAHH,CAGQ,SAAAC,GAAG,CAAI,CACXP,cAAc,CAACO,GAAG,CAACC,IAAJ,CAAST,WAAV,CAAd,CACAK,YAAY,CAACG,GAAG,CAACC,IAAJ,CAASL,SAAV,CAAZ,CACD,CANH,EAMKS,KANL,CAMW,UAAM,CACb;AACD,CARH,EASD,CAV2B,CAUzB,CAACT,SAAS,CAAG,EAAb,EAAmB,IAVM,CAA5B,CAYA,MAAO,kBAAMY,CAAAA,aAAa,CAACF,QAAD,CAAnB,EAAP,CACD,CAfQ,CAeN,CAACZ,YAAD,CAAeE,SAAf,CAfM,CAAT,CAiBA,MAAOJ,CAAAA,WAAP,CACD","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from 'axios';\n\nexport default function useAuth(code) {\n  const [accessToken, setAccessToken] = useState();\n  const [refreshToken, setRefreshToken] = useState();\n  const [expiresIn, setExpiresIn] = useState();\n\n  useEffect(() => {\n    axios.post('http://localhost:3001/login', {\n      code,\n    })\n      .then(res => {\n        setAccessToken(res.data.accessToken);\n        setRefreshToken(res.data.refreshToken);\n        setExpiresIn(res.data.expiresIn);\n        window.history.pushState({}, null, '/')\n      }).catch(() => {\n        // window.location = '/'\n      })\n  }, [code])\n\n  useEffect(() => {\n    if (!refreshToken || !expiresIn) return;\n    const interval = setInterval(() => {\n      axios.post('http://localhost:3001/refresh', {\n        refreshToken,\n      })\n        .then(res => {\n          setAccessToken(res.data.accessToken);\n          setExpiresIn(res.data.expiresIn);\n        }).catch(() => {\n          // window.location = '/'\n        })\n    }, (expiresIn - 60) * 1000)\n\n    return () => clearInterval(interval)\n  }, [refreshToken, expiresIn])\n\n  return accessToken;\n}\n\n"]},"metadata":{},"sourceType":"module"}