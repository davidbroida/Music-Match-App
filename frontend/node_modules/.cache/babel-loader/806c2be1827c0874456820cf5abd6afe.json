{"ast":null,"code":"import _slicedToArray from\"/Users/davidbroida/Desktop/MusicMatch2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Container,Form}from'react-bootstrap';import SpotifyWebApi from'spotify-web-api-node';import axios from'axios';import Song from'./Song';import Player from'./Player';import useAuth from'../hooks/useAuth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SpotifyApi=new SpotifyWebApi({clientId:'04306bc8614e44bbb0f6f8071bb81e01'});function SearchPage(){// let code = localStorage.getItem('code');\n// const accessToken = useAuth(code);\n// console.log(accessToken)\nvar accessToken=localStorage.getItem('code');var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),search=_useState2[0],setSearch=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),searchResults=_useState4[0],setSearchResults=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),playingSong=_useState6[0],setPlayingSong=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),lyrics=_useState8[0],setLyrics=_useState8[1];function chooseSong(song){setPlayingSong(song);setSearch('');setLyrics('');}useEffect(function(){if(!playingSong)return;axios.get('/lyrics',{params:{track:playingSong.title,artist:playingSong.artist}}).then(function(res){setLyrics(res.data.lyrics);});},[playingSong]);useEffect(function(){if(!accessToken)return;SpotifyApi.setAccessToken(accessToken);},[accessToken]);useEffect(function(){if(!search)return setSearchResults([]);if(!accessToken)return;SpotifyApi.searchTracks(search).then(function(res){setSearchResults(res.body.tracks.items.map(function(track){var smallestAlbumImage=track.album.images.reduce(function(smallest,image){if(image.height<smallest.height)return image;return smallest;},track.album.images[0]);return{artist:track.artists[0].name,title:track.name,uri:track.uri,albumUrl:smallestAlbumImage.url};}));});},[search,accessToken]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-page-title\",children:/*#__PURE__*/_jsx(\"h4\",{children:\"Search your favorite music...\"})}),/*#__PURE__*/_jsxs(Container,{className:\"d-flex flex-column py-2\",style:{height:\"100vh\",marginTop:'20px'},children:[/*#__PURE__*/_jsx(Form.Control,{type:\"search\",placeholder:\"Enter a song/ artist...\",value:search,onChange:function onChange(e){return setSearch(e.target.value);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 my-2\",style:{overflowY:\"auto\"},children:[searchResults.map(function(song){return/*#__PURE__*/_jsx(Song,{song:song,chooseSong:chooseSong},song.uri);}),searchResults.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",style:{whiteSpace:\"pre\"},children:lyrics})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Player,{accessToken:accessToken,trackUri:playingSong===null||playingSong===void 0?void 0:playingSong.uri})})]})]});}export default SearchPage;","map":{"version":3,"sources":["/Users/davidbroida/Desktop/MusicMatch2/frontend/src/components/SearchPage.js"],"names":["React","useState","useEffect","Container","Form","SpotifyWebApi","axios","Song","Player","useAuth","SpotifyApi","clientId","SearchPage","accessToken","localStorage","getItem","search","setSearch","searchResults","setSearchResults","playingSong","setPlayingSong","lyrics","setLyrics","chooseSong","song","get","params","track","title","artist","then","res","data","setAccessToken","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","height","artists","name","uri","albumUrl","url","marginTop","e","target","value","overflowY","length","whiteSpace"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Container, Form } from 'react-bootstrap';\nimport SpotifyWebApi from 'spotify-web-api-node';\nimport axios from 'axios';\nimport Song from './Song';\nimport Player from './Player';\nimport useAuth from '../hooks/useAuth';\n\n\n\nconst SpotifyApi = new SpotifyWebApi({\n  clientId: '04306bc8614e44bbb0f6f8071bb81e01'\n})\n\n\nfunction SearchPage() {\n  // let code = localStorage.getItem('code');\n  // const accessToken = useAuth(code);\n  // console.log(accessToken)\n  const accessToken = localStorage.getItem('code');\n  const [search, setSearch] = useState(\"\");\n  const [searchResults, setSearchResults] = useState([]);\n  const [playingSong, setPlayingSong] = useState();\n  const [lyrics, setLyrics] = useState('');\n\n\n  function chooseSong(song) {\n    setPlayingSong(song);\n    setSearch('');\n    setLyrics('');\n  }\n\n  useEffect(() => {\n    if (!playingSong) return\n\n    axios.get('/lyrics', {\n      params: {\n        track: playingSong.title,\n        artist: playingSong.artist,\n      }\n    }).then(res => {\n      setLyrics(res.data.lyrics);\n    })\n  }, [playingSong])\n\n  useEffect(() => {\n    if (!accessToken) return;\n    SpotifyApi.setAccessToken(accessToken)\n  }, [accessToken]);\n\n  useEffect(() => {\n    if (!search) return setSearchResults([])\n    if (!accessToken) return;\n\n    SpotifyApi.searchTracks(search).then(res => {\n\n      setSearchResults(res.body.tracks.items.map(track => {\n        const smallestAlbumImage = track.album.images.reduce((smallest, image) => {\n          if (image.height < smallest.height) return image\n          return smallest\n        }, track.album.images[0])\n\n\n        return {\n          artist: track.artists[0].name,\n          title: track.name,\n          uri: track.uri,\n          albumUrl: smallestAlbumImage.url\n        }\n      }))\n    })\n  }, [search, accessToken])\n\n  return (\n    <div>\n      <div className=\"search-page-title\">\n        <h4>Search your favorite music...</h4>\n      </div>\n      <Container className=\"d-flex flex-column py-2\" style={{ height: \"100vh\", marginTop: '20px' }} >\n        <Form.Control type=\"search\" placeholder=\"Enter a song/ artist...\" value={search} onChange={e => setSearch(e.target.value)} />\n        <div className=\"flex-grow-1 my-2\" style={{ overflowY: \"auto\" }}>\n          {searchResults.map(song => (\n            < Song song={song} key={song.uri} chooseSong={chooseSong} />\n          ))}\n          {/* {code} */}\n\n          {searchResults.length === 0 && (\n            <div className=\"text-center\" style={{ whiteSpace: \"pre\" }}>\n              {lyrics}\n\n            </div>\n          )}\n\n        </div>\n        <div>\n          <Player accessToken={accessToken} trackUri={playingSong?.uri} />\n        </div>\n      </Container >\n    </div>\n  )\n}\n\nexport default SearchPage;"]},"metadata":{},"sourceType":"module"}